version: 2

exposures:
  - name: cloud_professional_exposures
    type: application
    description: |
      Insert or update Cloud Professional Subscriptions, accounts and contacts to Salesforce via Hightouch. Uses BLAPI data to identify customers. Customers with cloud professional subscriptions data
      is merged with salesforce data in ORGM to identify existing contacts/accounts/opportuntities.
      
      There are hightouch syncs configured:

      New subscriptions and updates
        1. New cloud professional accounts are stored in view `freemium_account`, inserted into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44311)).
        2. Existing cloud professional accounts are stored in view `freemium_account_update`, updated into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44312)).
        3. New cloud professional contacts are stored in view `freemium_contacts`, inserted into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44313)).
        4. Existing cloud professional contacts are stored in view `freemium_contacts_update`, updated into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44312))
        5. New cloud professional opportunities are stored in view `freemium_opportunity`, inserted into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44315)).
        6. New cloud professional opportunitylineitem are stored in view `freemium_opportunitylineitem_for_insert`, inserted into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44316)).
        7. Existing cloud professional opportunitylineitem are stored in view `freemium_opportunitylineitem_for_update`, currently not updating to salesforce.
      Cancelled subscriptions
        1. Cancelled cloud professional accounts are stored in view `cancelled_account_update`, updated into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44320)).
        2. Cancelled cloud professional opportunities are stored in view `cancelled_opportunity_update`, updated into salesforce via ([hightouch sync](https://app.hightouch.com/mattermost-com/syncs/44318)).
    url: https://app.hightouch.com/mattermost-com/syncs?search=Cloud+Professional
    tags:
      - hightouch
      - salesforce
    maturity: low
    owner:
      name: Munish Sharma
      email: munish.sharma@mattermost.com
    depends_on:
      - ref('freemium_account')
      - ref('freemium_account_update')
      - ref('freemium_contacts')
      - ref('freemium_contacts_update')
      - ref('freemium_opportunity')
      - ref('freemium_opportunitylineitem_for_insert')
      - ref('freemium_opportunitylineitem_for_update')
      - ref('cancelled_account_update')
      - ref('cancelled_update_opportunity')
